<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Isaac Vock" />


<title>Differential kinetic analysis with bakR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>

<style type="text/css">
p.abstract{
text-align: center;
font-weight: bold;
}
div.abstract{
margin: auto;
width: 90%;
}
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Differential kinetic analysis with
bakR</h1>
<h4 class="author">Isaac Vock</h4>
<div class="abstract">
<p class="abstract">Abstract</p>
<p>In a standard RNA-seq experiment, differential expression analysis is
incredibly common. The idea is to compare the expression of thousands of
RNA features (e.g., transcripts) between two conditions, which I’ll
refer to as the reference and experimental samples. Once you have
compiled a list of genes whose expressions differ significantly between
the two conditions, a reasonable follow-up question is “what caused the
change in each of the genes”? The three broad answers to that question
are 1) Something altered the RNA synthesis rates; 2) Something altered
the RNA degradation rates; or 3) A little bit of both 1) and 2).
Unfortunately, it is difficult to answer this question unambiguously
with stanard RNA-seq alone.</p>
<p>If the kinetics is of interest to you, then a recently developed
solution to this problem is nucleotide recoding RNA-seq, which exists in
several fundamentally similar flavors, the primary ones being
TimeLapse-seq, SLAM-seq, and TUC-seq. The strategy involves feeding
cells with a metabolic label (typically 4-thiouridine, a.k.a.
s<sup>4</sup>U), extracting the RNA as you normally would for RNA-seq,
and then using a unique chemistry to convert the metabolic label into
something that a sequencer will read as a different base (e.g., a
cytosine analog for s<sup>4</sup>U). Thus, labeled and unlabeled reads
can be separated bioinformatically upon sequencing by the presence of
mutations (e.g., U-to-C mutations).</p>
<p>One problem though; the metabolic label must 1st get into cells, and
then it must compete with the normal nucleotide for incorporation into
RNA. The result of this is that mutation rates are typically low (often
around 5% in RNA produced during metabolic labeling, meaning that each U
in a sequencing read from these RNAs has about a 5% chance of being
mutated to a C), making simple and definitive separation of labeled and
unlabeled reads impossible. In addition, statistical power of
comparative analyses of NR-seq datasets can be limited by the small
number of replicates typically collected, and the need for multiple-test
adjustment of p-values. The solution: advanced statistical modeling
implemented by bakR (now <a href="https://rnajournal.cshlp.org/content/29/7/958.abstract">published
in RNA</a>), an R package for analyzing nucleotide recoding RNA
sequencing data. bakR relies on Bayesian hierarchical mixture modeling
of NR-seq data to increase statistical power by sharing information
across transcripts and address the aforementioned challenges.The
analyses implemented in this package will enable you to perform
differential kinetic analysis just as easily as you can perform
differential expression analysis, allowing you to elucidate the
mechanisms of regulated gene expression.</p>
</div>



<div id="necessary-setup" class="section level2">
<h2>Necessary Setup</h2>
<p>Of course you will want to load the bakR package for this vignette;
instructions to do so can be found at this <a href="https://simonlabcode.github.io/bakR/index.html">link</a>. Also,
you’ll want to set the seed so as to ensure the results you get
reproduce those presented in the vignette.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(bakR)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code></pre></div>
</div>
<div id="step-1-creating-a-bakrdata-object" class="section level2">
<h2>Step 1: Creating a bakRData Object</h2>
<p>The 1st step to using bakR is to create a bakRData object. A bakRData
object consists of two components: a cB data frame and a metadf data
frame. cB stands for counts binomial and contains all of the information
about mutations seen in sequencing reads in each sample sequenced.
metadf stands for metadata data frame and contains important information
about the experimental details of each sample (i.e., how long the
metabolic label feed was, which samples are reference samples, and which
are experimental samples).</p>
<p>Lets get an idea for what a cB looks like by taking a peak at an
example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Load small example cB</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cB_small&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Observe contents of cB</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">head</span>(cB_small)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">nT</th>
<th align="left">XF</th>
<th align="right">TC</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">WT_ctl</td>
<td align="right">9</td>
<td align="left">ENSG00000156928</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">WT_ctl</td>
<td align="right">11</td>
<td align="left">ENSG00000105849</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">WT_ctl</td>
<td align="right">12</td>
<td align="left">ENSG00000100242</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">WT_ctl</td>
<td align="right">12</td>
<td align="left">ENSG00000105849</td>
<td align="right">0</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">WT_ctl</td>
<td align="right">12</td>
<td align="left">ENSG00000196295</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">WT_ctl</td>
<td align="right">12</td>
<td align="left">ENSG00000198937</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>One key aspect of the cB dataframe to keep in mind is that each row
corresponds to a set of reads providing identical data. To help that
make more sense, and to understand what information the cB tracks, let’s
go through the contents of each column:</p>
<ol style="list-style-type: decimal">
<li><strong>sample</strong>: This is the name of the sample from which
the reads described in this row originated. Usually this will be some
sort of character vector that you have defined.</li>
<li><strong>TC</strong>: Number of U-to-C mutations (assuming using
s<sup>4</sup>U as the metabolic label). Called TC because technically
the data is T-to-C mutations in reverse-transcribed RNA</li>
<li><strong>nT</strong>: Number of Ts (Us in the RNA) in the sequencing
read(s)</li>
<li><strong>XF</strong>: Name of the feature (gene, exon, etc.) that the
read comes from. Kinetic parameters will be estimated for each feature,
so this should represent the functional unit who’s metabolic kinetics
you are interested in.
<ul>
<li><strong>XF</strong> stands for “exonic feature”, since in most cases
you should only be considering reads that map to definitively exonic
locations. Introns are typically rapidly turned over and thus will be
highly labeled species that will bias estimates of mature transcript
stability.</li>
</ul></li>
<li><strong>n</strong>: Number of reads with identical data for the
other 4 columns. For example, n = 3 in the 2nd row means that there are
3 reads from sample WT_cntl (WT cells not treated with s<sup>4</sup>U)
that mapped to <strong>XF</strong> ENSG00000100242 (SUN2), had 0 T to C
mutations, and had 11 Ts.</li>
</ol>
<p>The structure of the cB file most closely reflects the output of a
pipeline for analyzing nucleotide recoding RNA-seq data developed by the
Simon lab (available as a Snakemake reimplementation <a href="https://github.com/simonlabcode/bam2bakR">here</a>).</p>
<p>Now let’s look at the corresponding metadf dataframe:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Load metadf data frame; will be loaded as metadf in global environment</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;metadf&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Print the transpose of metadf</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Rows will be the columns and columns will be the rows</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">t</span>(metadf))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">WT_ctl</th>
<th align="right">WT_2</th>
<th align="right">WT_1</th>
<th align="right">KO_ctl</th>
<th align="right">KO_2</th>
<th align="right">KO_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tl</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Exp_ID</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>The transpose of metadf is displayed above to save space (so the
columns depicted are the rows of metadf, and vice versa). Metadf has
significantly less information than the cB data frame, but it’s crucial
information. One extremely important feature of metadf is its row names
(column names as depicted above). Examine the row names and compare them
to the sample names</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># metadf row names</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">rownames</span>(metadf))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;WT_ctl&quot; &quot;WT_2&quot;   &quot;WT_1&quot;   &quot;KO_ctl&quot; &quot;KO_2&quot;   &quot;KO_1&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># cB sample names</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(cB_small<span class="sc">$</span>sample))</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;WT_ctl&quot; &quot;WT_2&quot;   &quot;WT_1&quot;   &quot;KO_ctl&quot; &quot;KO_2&quot;   &quot;KO_1&quot;</span></span></code></pre></div>
<p>They’re the same, and they HAVE TO BE!! Each row of metadf
corresponds to a sample, and the order in which the sample names appear
as the row names of metadf <strong>MUST</strong> correspond to the order
they appear in cB sample column. (NOTE: in bakR version 1.0.0 this is no
longer the case; the sample names in the cB just have to appear in the
metadf in any order).</p>
<p>Keeping in mind that each row represents a sample, the content of the
columns are:</p>
<ol style="list-style-type: decimal">
<li><strong>tl</strong>: The length of the metabolic labeling feed. This
can be in any units (the simulated data puts it in terms of minutes),
but <strong>if no s<sup>4</sup>U was fed to a sample, tl must be 0 for
that sample</strong>. While not technically necessary to run bakR, we
always highly suggest including -s<sup>4</sup>U controls.</li>
<li><strong>Exp_ID</strong>: Stands for “Experimental ID” and is a
numerical ID that denotes which samples are from the reference condition
and which experimental samples belong to the same “treatment”. In this
simulated dataset, there are two conditions, a reference condition
(samples 1, 2, 3, and 7) and a single experimental condition (samples 4,
5, 6, and 8). <strong>The reference condition must be given numerical ID
1</strong> and <strong>the experimental conditions must be given
sequential numerical IDs starting from 2</strong> (i.e., 2, 3, 4, …).
You can have more than one experimental sample, but all comparisons will
only be done with respect to one reference sample.
<ul>
<li>If you want to compare two experimental samples, this can be done
with the output of the models, though it will require a bit of post-hoc
work on your end.</li>
</ul></li>
</ol>
<p>Once you have these two data frames correctly constructed, you can
create a bakRData object in one line of code.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Create bakRData object</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>bakRData <span class="ot">&lt;-</span> <span class="fu">bakRData</span>(cB_small, metadf)</span></code></pre></div>
</div>
<div id="step-2-fitting-the-efficient-model" class="section level2">
<h2>Step 2: Fitting the Efficient Model</h2>
<p>bakR implements several blends of fundamentally similar statistical
models to perform differential kinetic analysis. No matter your
intentions though, you must first fit data with the most efficient model
available. This model (implemented in the fast_analysis() function, so
see ?fast_analysis for more details) estimates mutation rates and then
finds the maximum likelihood estimate (MLE) for the fraction of
sequencing reads from new RNA (new meaning RNA synthesized after the
start of metabolic labeling) for each feature in each s<sup>4</sup>U fed
sample. The reason you have to run this model is that some part of its
output will be used by every other model you can run with bakR. More on
that later though; first, let’s create a simulated dataset and fit
bakR’s model with the efficient implementation. Using a simulated
dataset will allow us to compare the results to the ground truth and
validate its accuracy.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Simulate a nucleotide recoding dataset</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">Simulate_bakRData</span>(<span class="dv">500</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="co"># This will simulate 500 features, 2 experimental conditions</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="co"># and 3 replicates for each experimental condition</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="co"># See ?Simulate_bakRData for details regarding tunable parameters</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># Extract simulated bakRData object</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>bakRData <span class="ot">&lt;-</span> sim_data<span class="sc">$</span>bakRData</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co"># Extract simualted ground truths</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>sim_truth <span class="ot">&lt;-</span> sim_data<span class="sc">$</span>sim_list</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co"># Run the efficient model</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>Fit <span class="ot">&lt;-</span> <span class="fu">bakRFit</span>(bakRData)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; Finding reliable Features</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; Filtering out unwanted or unreliable features</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; Processing data...</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; Estimating pnew with likelihood maximization</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; Estimating unlabeled mutation rate with -s4U data</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; Estimated pnews and polds for each sample are:</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; # Groups:   mut [2]</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt;     mut  reps   pnew    pold</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; 1     1     1 0.0502 0.00100</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; 2     1     2 0.0500 0.00100</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; 3     1     3 0.0501 0.00100</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; 4     2     1 0.0501 0.00100</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; 5     2     2 0.0500 0.00100</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; 6     2     3 0.0503 0.00100</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; Estimating fraction labeled</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; Estimating per replicate uncertainties</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; Estimating read count-variance relationship</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; Averaging replicate data and regularizing estimates</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; Assessing statistical significance</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt; All done! Run QC_checks() on your bakRFit object to assess the </span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt;             quality of your data and get recommendations for next steps.</span></span></code></pre></div>
<p>bakRFit() is used here as a wrapper for two functions in bakR:
cBprocess() and fast_analysis(). cBprocess() will extract and properly
format the information needed for all statistical models from the
bakRData object and fast_analysis() will perform the efficient analysis.
This should take no more than a minute to run. Messages are printed
along the way to keep you updated as to the progress of the
analysis.</p>
<p>One of the most important messages is that regarding the estimated
pnews and pold. The pnews are the estimated mutation rates of reads from
new RNAs (new meaning RNAs synthesized after the start of s<sup>4</sup>U
labeling) in each sample (muts = Exp_ID, and reps = a numerical
replicate ID that corresponds to the order replicates appear in the cB),
and pold is a global estimate of the background mutation rate used in
all analyses. The simulated mutation rates are 0.05 for new reads and
0.001 for old reads in all samples this simulation, so the estimates are
pretty darn close. You can also input mutation rate estimates from
elsewhere (say a run of the full Stan model implemented in bakR) to
bakRFit():</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Run efficient model with known mutation rates</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># Pass the Fit object rather than the bakRData object and set FastRerun to TRUE</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>Fit <span class="ot">&lt;-</span> <span class="fu">bakRFit</span>(Fit,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                     <span class="at">FastRerun =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                     <span class="at">pnew =</span> <span class="fu">rep</span>(<span class="fl">0.05</span>, <span class="at">times =</span> <span class="dv">6</span>), </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                     <span class="at">pold =</span> <span class="fl">0.001</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; Using provided pnew estimates</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; Using provided pold estimate</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; Estimated pnews and polds for each sample are:</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;   mut reps pnew  pold</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; 1   1    1 0.05 0.001</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; 2   1    2 0.05 0.001</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; 3   1    3 0.05 0.001</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; 4   2    1 0.05 0.001</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; 5   2    2 0.05 0.001</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; 6   2    3 0.05 0.001</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; Estimating fraction labeled</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; Estimating per replicate uncertainties</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; Estimating read count-variance relationship</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; Averaging replicate data and regularizing estimates</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; Assessing statistical significance</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; All done! Run QC_checks() on your bakRFit object to assess the </span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt;             quality of your data and get recommendations for next steps.</span></span></code></pre></div>
<p>Since we’ve already run the fast_analysis once, we can speed up the
analysis by passing the Fit object from the first run rather than the
bakRData object. This allows bakR to skip the time consuming
pre-processing steps. Just make sure to set FastRerun to TRUE.</p>
<p>If you run into problems with the default mutation rate strategy
(e.g., the mutation rate estimates don’t seem to make sense) another
slightly less efficient solution is to use MCMC implemented in Stan to
estimate mutation rates. The idea is to fit a binomial mixture model to
only a small subset of features with sufficient sequencing depth so that
the model has enough data to work with while still running in a
reasonable amount of time:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Set StanRateEst to TRUE to use Stan to estimate rates</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># low_reads and high_reads defines the read count cutoffs used to select features</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="co"># default = between 1000 and 5000 reads</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># RateEst_size determines the number of features to use (default = 30)</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>Fit <span class="ot">&lt;-</span> <span class="fu">bakRFit</span>(Fit,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                     <span class="at">FastRerun =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>                     <span class="at">StanRateEst =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The “Troubleshooting” vignette has more details about when certain
mutation rate estimation strategies are preferable.</p>
<p>No matter how you decide to run the fast model, you might wonder how
well it worked. As mentioned earlier, one benefit of using simulated
data is that you can easily answer that question by comparing the
simulated parameters (e.g., the fraction new) to the model’s
estimates:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># Features that made it past filtering</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>XFs <span class="ot">&lt;-</span> <span class="fu">unique</span>(Fit<span class="sc">$</span>Fast_Fit<span class="sc">$</span>Effects_df<span class="sc">$</span>XF)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># Simulated logit(fraction news) from features making it past filtering</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>true_fn <span class="ot">&lt;-</span> sim_truth<span class="sc">$</span>Fn_rep_sim<span class="sc">$</span>Logit_fn[sim_truth<span class="sc">$</span>Fn_rep_sim<span class="sc">$</span>Feature_ID <span class="sc">%in%</span> XFs]</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co"># Estimated logit(fraction news)</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>est_fn <span class="ot">&lt;-</span> Fit<span class="sc">$</span>Fast_Fit<span class="sc">$</span>Fn_Estimates<span class="sc">$</span>logit_fn</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co"># Compare estimate to truth</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="fu">plot</span>(true_fn, est_fn, <span class="at">xlab =</span> <span class="st">&quot;True logit(fn)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Estimated logit(fn)&quot;</span>)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Looks pretty good to me! Note, a key assumption that is common to
make when analyzing NR-seq data is that the population of cells you are
analyzing is at steady-state. This means that RNA levels were constant
during the label time, i.e., your cells were not actively responding to
a perturbation during metabolic labeling. In that case, the fraction new
(<span class="math inline">\(\theta\)</span>) and the degradation rate
constant are related as follows:</p>
<p><span class="math display">\[
k_{\text{deg}} = -\frac{\text{ln}(1 - \theta)}{\text{tl}}
\]</span></p>
<p>To run the heavier, more trustworthy models, just rerun bakRFit() on
the Fit object, but with either the StanFit or HybridFit parameters set
to true.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Load options that will make running models more efficient</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># Run Hybrid model (This might take several minutes to run)</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>Fit <span class="ot">&lt;-</span> <span class="fu">bakRFit</span>(Fit, <span class="at">HybridFit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># Run Full model (This might take ~10-30 minutes to run)</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>Fit <span class="ot">&lt;-</span> <span class="fu">bakRFit</span>(Fit, <span class="at">StanFit =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>You might rightfully ask what it is that makes these models “more
trustworthy”? Didn’t we just show that the logit(fn) estimates for the
fast model were pretty good? Why bother with these computationally
expensive models?? The answer is that a lot of the magic happens at the
level of uncertainty quantification. While all models are going to agree
pretty well on estimates for kinetic parameters, they won’t necessarily
agree on how uncertain those estimates are. The fastest model takes a
lot of shortcuts and uses a lot of approximations that make it fast but
also make its uncertainty quantification less rigorous. I like to say
that the fast model should be used for initial investigations of your
data, a rapid means by which to satisfy your desire to dive into
whatever exciting biology you might be exploring. When you have a sense
of how promising your data is and what it is you want to analyze, switch
on over to the heavier models. These will give you more peace of mind
and allow you to comfortably dig a little deeper into your datasets as
you prepare for stunning presentations and groundbreaking papers. The
Hybrid implementation (<code>HybridFit = TRUE</code>) should usually be
your go-to for this, but particularly challenging to analyze datsets
(e.g., those with low new read mutation rates) can benefit from the full
MCMC implementation (<code>StanFit = TRUE</code>).</p>
<p>The Fit objects contain lists pertaining to the fits of each of the
models. The possible contents include:</p>
<ol style="list-style-type: decimal">
<li>Fast_Fit: Result of the initial fitting of the bakRData object. To
learn more about its contents, see ?fast_analysis()</li>
<li>Data_lists: Processed data that can be passed to the statistical
models</li>
<li>Hybrid_Fit: Result of running bakRFit() on the Fit object with
HybridFit = TRUE. To learn more about its contents, see ?TL_stan().</li>
<li>Stan_Fit: Result of running bakRFit() on the Fit object with StanFit
= TRUE. Its general contents are identical to the Hybrid_Fit, even
though the models are different.</li>
</ol>
</div>
<div id="step-3-visualizing-the-results" class="section level2">
<h2>Step 3: Visualizing the Results</h2>
<p>bakR provides a variety of easy to use functions for beginning to
investigate your data. The visualizations are particularly aimed at
revealing trends in RNA stabilization or destabilization. Analyzing
changes in RNA synthesis rate will require pairing the output of bakR
with that of a differential expression analysis tool, like DESeq2,
edgeR, or limma. More on that in the “Differential synthesis analysis”
vignette.</p>
<p>One visualization powered by bakR is a L2FC(kdeg) MA plot. Each point
in these plots will represent a feature-condition combination. The
x-axis is the average number of sequencing reads mapping to that
feature, averaging over all replicates in both the experimental and
reference condition. The y-axis is the difference in stability between
the reference and experimental condition, quantified as a log2-fold
change (L2FC) in the degradation rate constant (kdeg). Positive values
of L2FC(kdeg) represent features that are less stable (have a higher
kdeg) in the experimental condition relative to the reference condition.
Negative values thus represent features that are more stable in the
experimental condition. The plotMA function in bakR allows you to make
this plot with two inputs, the bakRFit object and the model fit to use
(MLE, Hybrid, or MCMC):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="do">## MA Plot with Fast Fit</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>bakR<span class="sc">::</span><span class="fu">plotMA</span>(Fit, <span class="at">Model =</span> <span class="st">&quot;MLE&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>If you have more than one experimental condition, you can choose to
plot all comparisons or just a subset of those in which you are
interested. See the Exps and Exp_shape parameters in the ?plotMA help
file for details.</p>
<p>Another common plot to make with the bakR fits is a volcano plot. The
x-axis in a volcano plot is the same as the y-axis of an MA plot (so
L2FC in a kinetic parameter), and the y-axis is a measure of statistical
significance (e.g., FDR adjusted p-value), usually on a -log10 scale.
The plotVolcano function is here to help you with this one too,
containing many of the same parameters as plotMA:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="do">## Volcano Plot with Fast Fit; significance assessed relative to an FDR control of 0.05</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">plotVolcano</span>(Fit<span class="sc">$</span>Fast_Fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>While volcano and MA plots are great for visualizing the results of
bakR’s model fits, another important class of plots are those to detect
anomalies. Sometimes, high-throughput sequencing datasets are plagued by
batch effects, biases that effect one or a few of your samples. These
can lead to inflated false discovery rates and/or reduced power and are
thus important to look out for. One simple way to see if there are
large-scale biases present in any of your samples is to perform
principle component analysis (PCA), a dimension reduction algorithm that
will project your high-dimensional sequencing data onto a few
dimensions. bakR specifically implements a novel fraction new PCA, where
the high-dimensional object to be compressed is a matrix of fraction new
estimates, with each column of the matrix corresponding to a sample and
each row a feature (e.g., a transcript). If replicates don’t cluster
together in the 2D PCA plot produced by bakR’s FnPCA, that could
indicate the presence of batch effects:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">## 2D PCA plot with replicate fraction news</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="co"># The equivalent function prior to version 1.0.0 is FnPCA, now deprecated in </span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="co"># favor of FnPCA2.</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">FnPCA2</span>(Fit, <span class="at">Model =</span> <span class="st">&quot;MLE&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In this case, replicates separate from each other fairly well, which
is promising and the difference between the red point in the lower left
and those in the upper left is not significant enough to cause
concern.</p>
</div>
<div id="step-4-where-to-go-from-here" class="section level2">
<h2>Step 4: Where to go from here</h2>
<p>I hope that this vignette has provided a useful introduction to using
bakR with your nucleotide recoding RNA-seq datasets. Inevitably, not all
of your questions will be answered in the Getting-Started vignette. Some
of your remaining quandaries may be challenging problems specific to
your exciting research, the unavoidable roadblocks of doing science that
you will eventually conquer, but with little help from any documentation
I could dream of writing. That being said, I can still imagine many
important implementation questions not addressed here. Therefore, a
number of additional vignettes exist to discuss:</p>
<ol style="list-style-type: decimal">
<li>Performing differential synthesis rate analyses with bakR.</li>
<li>Providing fraction new estimates as input rather than a cB data
frame (as of version 1.0.0).</li>
<li>Correcting for disproportionate loss of metabolic label containing
RNA/reads.</li>
<li>Dissecting the mechanisms of gene expression regulation while
relaxing the steady-state assumption.</li>
<li>General advice when troubleshooting analyses of NR-seq
datasets.</li>
</ol>
<p>In addition, it’s possible that you will run into warnings about
r_hats and n_eff while running some of the heavier Stan models. If that
is the case, I would suggest checking out some of the <a href="https://mc-stan.org/misc/warnings.html">great documentation</a>
written by the Stan team. In short though, warnings from Stan are a sign
that the model did not converge. A possible cause of this is anomalies
in your data. Some challenges that I have come across that could lead to
such warnings include:</p>
<ol style="list-style-type: decimal">
<li>Did you analyze a mix of technical and biological replicates?
Technical replicates will have much less replicate to replicate
variability than biological replicates, which will confuse and crash the
models.</li>
<li>Is your s<sup>4</sup>U label time abnormally long or short? If you
are getting warnings from running the MLE implementation about
logit(fn)s being at the lower or upper bounds, this could be the case.
It means that there will be some extreme mutational data (e.g., 0
mutations in any sequencing read) that will make analysis with the MCMC
implementation more difficult. Try filtering out these extreme
transcripts and rerunning bakR if this is the case.</li>
<li>Do you have any extreme batch effects. Check the FnPCA2 plot;
extreme differences between replicates could also break the models.</li>
<li>Are you analyzing short sequencing reads? bakR has not yet been
fully validated on short sequencing read nucleotide recoding RNA-seq
data (e.g., read lengths less than 50 nucleotides), so exercise caution
when analyzing this kind of data with bakR. Mutation rate estimation can
also pose a challenge for bakR in this case. To get around these
problems, try using the mutation rate estimates from the MCMC
implementation (which I have found to be accurate even when model
convergence is an issue) in the MLE implementation.</li>
</ol>
<p>Sometimes, small warnings from Stan (like a few max treedepth
warnings here and there) are no cause for concern. How do you know
whether or not there is a serious problem though? I would suggest
comparing the output of the Hybrid/MCMC implementation to that of the
MLE implementation. In particular, check the correlation between the
L2FC(kdeg) estimates. If the correlation is good, then there probably is
nothing to worry about. If the estimates for a handful of transcripts
differ wildly between the implementations though, that is strong
evidence that the convergence issues are serious and that one of the
anomalies mentioned above is afflicting your data.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
